<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>Manual T&eacute;cnico</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

</style>
            
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-light">
            <!-- title: Manual Técnico --> 
<h1 id="manual-técnico">Manual Técnico</h1>
<div>
    <img src="https://www.ips.pt/ips_si/imagens/_ips-logotipo-site-2023" alt="Logo IPS" align="right">
    <p><strong>Programação e Integração de Serviços</strong></p>
    <p>CTeSP – TPSI</p>
    <p>Projeto de Época Normal – 2023/2024</p>
    <p>Docente Bruno Pereira</p>
    <p>Alunos:</p>
    <ul>
        <li>André Carvalho 202200878</li>
        <li>Diogo Veigas 202200879</li>
    </ul>
</div>
<h2 id="índice">Índice</h2>
<ul>
<li><a href="#manual-t%C3%A9cnico">Manual Técnico</a>
<ul>
<li><a href="#%C3%ADndice">Índice</a></li>
<li><a href="#introdu%C3%A7%C3%A3o">Introdução</a></li>
<li><a href="#instala%C3%A7%C3%A3o-da-aplica%C3%A7%C3%A3o">Instalação da Aplicação</a></li>
<li><a href="#arquitetura-da-aplica%C3%A7%C3%A3o">Arquitetura da Aplicação</a>
<ul>
<li><a href="#estrutura-de-diret%C3%B3rios">Estrutura de Diretórios:</a></li>
<li><a href="#express-app">Express App:</a></li>
<li><a href="#rotas">Rotas:</a></li>
<li><a href="#controladores-modelos-e-a%C3%A7%C3%B5es">Controladores, Modelos e Ações:</a></li>
<li><a href="#entidades-principais">Entidades principais:</a></li>
<li><a href="#base-de-dados">Base de Dados:</a></li>
</ul>
</li>
<li><a href="#web-services">Web Services</a>
<ul>
<li><a href="#tipos-de-servi%C3%A7o">Tipos de Serviço:</a></li>
<li><a href="#uso-dos-servi%C3%A7os">Uso dos Serviços:</a></li>
<li><a href="#exemplos-pr%C3%A1ticos">Exemplos Práticos:</a></li>
</ul>
</li>
<li><a href="#integra%C3%A7%C3%A3o-de-servi%C3%A7os-externos">Integração de Serviços Externos</a></li>
<li><a href="#funcionalidades-implementadas">Funcionalidades Implementadas</a></li>
<li><a href="#tecnologias-utilizadas">Tecnologias Utilizadas</a></li>
<li><a href="#mais-informa%C3%A7%C3%B5es">Mais Informações</a></li>
</ul>
</li>
</ul>
<h2 id="introdução">Introdução</h2>
<p>Este manual tem como objetivo fornecer uma compreensão abrangente da API desenvolvida para o projeto de Gestão de Receitas. Aqui, encontrará informações detalhadas sobre a arquitetura da aplicação, os web services implementados, a integração de serviços externos, as funcionalidades disponíveis e as tecnologias utilizadas.</p>
<p>Durante a leitura deste manual, será guiado através dos componentes fundamentais que compõem a estrutura da aplicação, aprenderá sobre os serviços web que possibilitam a manipulação eficiente da base de dados, entenderá como serviços externos foram incorporados para aprimorar a experiência do utilizador e descobrirá as diversas funcionalidades implementadas para atender às exigências do projeto.</p>
<p>A divisão por secções facilitará a procura de informações específicas, proporcionando uma leitura fluída e eficiente. Vamos explorar, passo a passo, cada aspecto essencial da API, desde a sua arquitetura até as tecnologias subjacentes que a sustentam.</p>
<p>Com base nos documentos fornecidos, a arquitetura da aplicação pode ser descrita da seguinte forma:</p>
<h2 id="instalação-da-aplicação">Instalação da Aplicação</h2>
<p>Para instalar a aplicação (API e frontend), siga os passos abaixo:</p>
<ol>
<li>
<p><strong>Node.js e NPM:</strong></p>
<ul>
<li>Instale o <a href="https://nodejs.org/en">Node.js</a> (escolha a versão LTS).</li>
<li>Inclua a instalação do NPM (Node Package Manager).</li>
</ul>
</li>
<li>
<p><strong>MySQL:</strong></p>
<ul>
<li>Instale o <a href="https://dev.mysql.com/downloads/workbench/">MySQL Workbench</a>.</li>
</ul>
</li>
<li>
<p><strong>Configuração e Inicialização:</strong></p>
<ul>
<li>Abra o terminal na pasta raiz e execute: <code>npm i</code> para instalar as dependências.</li>
<li>Execute o servidor de banco de dados.</li>
<li>Configure o arquivo <code>.env</code> com variáveis de ambiente.</li>
</ul>
</li>
<li>
<p><strong>Inicialização do Servidor:</strong></p>
<ul>
<li>Execute <code>npm start</code> no terminal.</li>
</ul>
</li>
</ol>
<h2 id="arquitetura-da-aplicação">Arquitetura da Aplicação</h2>
<p>A aplicação segue uma arquitetura RESTful, baseada no padrão MVC, em que a aplicação está dividida em modelos, vistas e controladores, que no caso desta aplicação estão sub divididos em rotas e ações.
De seguida, poderá encontrar a estrutura de pastas, as configurações da framework Express, bem como outros detalhes importantes para a aplicação como um todo:</p>
<h3 id="estrutura-de-diretórios">Estrutura de Diretórios:</h3>
<ul>
<li><strong>static:</strong> Recursos estáticos.</li>
<li><strong>views:</strong> Arquivos de visualização (Mustache).</li>
<li><strong>api:</strong> Manipulação de requisições relacionadas à API.
<ul>
<li><strong>api/controllers:</strong> Controladores para a lógica de negócios.</li>
<li><strong>api/models:</strong> Modelos de dados.</li>
<li><strong>api/actions:</strong> Lógica específica para ações.</li>
<li><strong>api/routes:</strong> Agregação de rotas da API.</li>
</ul>
</li>
<li><strong>app:</strong> Gerenciamento de rotas do frontend.
<ul>
<li><strong>app/user:</strong> Parte do utilizador (backoffice).</li>
<li><strong>app/admin:</strong> Gestão de dados (backoffice).</li>
</ul>
</li>
<li><strong>.env:</strong> Variáveis de ambiente sensíveis.</li>
</ul>
<h3 id="express-app">Express App:</h3>
<ul>
<li>
<p><strong>Inicialização:</strong>
Carrega as dependências necessárias como <code>express</code>, <code>body-parser</code>, <code>mustache-express</code>, e <code>dotenv</code>.
Configuração do ambiente utilizando o arquivo <code>.env</code>.</p>
</li>
<li>
<p><strong>Middlewares:</strong>
Utiliza o middleware <code>body-parser</code> para processar dados JSON.
Configura a manipulação de requisições estáticas e favicon.</p>
</li>
<li>
<p><strong>Configuração do Mustache:</strong>
Configura o mecanismo de visualização Mustache para renderizar as views.</p>
</li>
<li>
<p><strong>Roteamento:</strong>
Utiliza os roteadores <code>apiRouter</code> e <code>appRouter</code> para direcionar requisições para as rotas correspondentes.</p>
</li>
<li>
<p><strong>Tratamento de Erros:</strong>
Para os erros mais comuns de falha em encontrar a rota pedida, foi utilizada a resposta (<code>404 Not Found</code>).</p>
</li>
<li>
<p><strong>Inicialização do Servidor:</strong>
Inicia o servidor na porta especificada no arquivo <code>.env</code>.</p>
</li>
</ul>
<h3 id="rotas">Rotas:</h3>
<ul>
<li>
<p><strong>API Roteador:</strong>
Agrega todas as rotas da API, utilizando roteadores específicos para utilizadores, áreas, categorias, dificuldades, ingredientes, receitas e sementes.</p>
</li>
<li>
<p><strong>Roteador da Aplicação:</strong>
Roteia as requisições da aplicação principal.</p>
</li>
</ul>
<h3 id="controladores-modelos-e-ações">Controladores, Modelos e Ações:</h3>
<ul>
<li>
<p><strong>Controladores:</strong>
Agregam a lógica de manipulação de dados para utilizadores, áreas, categorias, dificuldades, ingredientes, receitas e sementes.</p>
</li>
<li>
<p><strong>Modelos:</strong>
Representam as entidades de dados da aplicação.</p>
</li>
<li>
<p><strong>Ações:</strong>
Contém a lógica específica para realizar ações relacionadas a utilizadores, áreas, categorias, dificuldades, ingredientes, receitas e sementes.</p>
</li>
</ul>
<h3 id="entidades-principais">Entidades principais:</h3>
<ul>
<li>
<p><strong>Utilizador:</strong>
Consiste nos utilizadores da aplicação, para além de determinar a sua autorização.</p>
</li>
<li>
<p><strong>Categoria:</strong>
Categoria de uma receita, pode facilitar na procura de receitas através da sua categoria.</p>
</li>
<li>
<p><strong>Ingredient:</strong>
Ingredientes tal como tomates e bananas, estes podem ser adicionados numa receita com a indicação da sua quantidade.</p>
</li>
<li>
<p><strong>Região:</strong>
Região de origem da receita.</p>
</li>
<li>
<p><strong>Dificuldade:</strong>
Dificuldade de preparo de uma dada receita.</p>
</li>
<li>
<p><strong>Receita:</strong>
A receita, composta por diversos atributos. É a entidade mais importante e mais dependente da API.</p>
</li>
</ul>
<h3 id="base-de-dados">Base de Dados:</h3>
<ul>
<li>
<p><strong>Tabelas Simples:</strong>
A base de dados é composta por múltiplas tabelas simples, sendo estas essenciais para um bom funcionamento e relacionamento dinâmico entre entidades. Um exemplo destas são os ingredientes, categorias e dificuldade.</p>
</li>
<li>
<p><strong>Tabelas Compostas:</strong>
Uma tabela composta são aquelas que possuem chaves estrangeiras para indicar um determinado valor, como exemplo, temos a tabela das receitas, que deve indicar a sua região, dificuldade, categoria, entre outros através de uma chave estrangeira.</p>
</li>
<li>
<p><strong>Tabelas Relacionais:</strong>
Ainda que todas as tabelas de uma base de dados relacional sejam relacionais, este nome foi escolhido para aquelas tabelas que servem para realizar os relacionamentos de N-N, isto é, relacionar receitas e ingredientes (recipe_ingredients), como também o relacionamento de receitas favoritas (favorite_recipes).</p>
</li>
<li>
<p><strong>Views:</strong>
A base de dados possui também algumas views para que seja mais fácil selecionar as receitas dos ingredientes, e realizar pesquisas mais rápidas com menos campos de forma mais eficiente (por exemplo, detalhes da receita, tabelas ou cartões).</p>
</li>
</ul>
<p>Esta arquitetura modular tenta seguir as boas práticas de desenvolvimento, separando claramente as responsabilidades entre diferentes componentes da aplicação.</p>
<h2 id="web-services">Web Services</h2>
<p>Nesta secção serão apresentados, de forma breve, os serviços web que esta API disponibiliza, uma descrição para cada serviço, bem como alguns exemplos práticos para facilitar a compreensão.</p>
<h3 id="tipos-de-serviço">Tipos de Serviço:</h3>
<ul>
<li>
<p><strong>Elementares:</strong>
Esta API é composta por múltiplos serviços, sendo a maioria deles elementares. Estes dizem-se elementares por ser de natureza simples, tal como a criação ou visualização de um dado recurso numa base de dados. De seguida, podem ser vistos todos os serviços disponíveis nesta API:</p>
<ul>
<li>Gestão de regiões;</li>
<li>Gestão de categorias;</li>
<li>Gestão de dificuldades;</li>
<li>Gestão de ingredientes;</li>
<li>Gestão de utilizadores.</li>
</ul>
</li>
<li>
<p><strong>Compostos:</strong>
Esta API possui também alguns serviços compostos, que utilizam um ou mais serviços elementares para efetuar operações mais complexas, como por exemplo, as ações de <em>seeding</em>, que consistem na remoção e criação de dados em massa provenientes de uma outra API externa.</p>
<ul>
<li>Outros serviços que podem ser considerados compostos são:
<ul>
<li>Gestão de receitas, quando criada ou editada podem ser incluídos os seus ingredientes;</li>
<li>Inserção em massa de novas categorias, regiões, dificuldades, receitas à base de dados;</li>
<li>Gestão de listas de receitas favoritas de um utilizador;</li>
<li>Etc.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="uso-dos-serviços">Uso dos Serviços:</h3>
<p>A descrição do uso dos serviços será organizada em várias secções para garantir abrangência sem repetição excessiva. A primeira parte abordará o uso de serviços elementares, destacando a gestão de ingredientes, receitas e categorias. Em seguida, serão exploradas práticas de autenticação e autorização. Posteriormente, serão apresentados serviços mais complexos, exemplificados pela orquestração na gestão de ingredientes. Por fim, serão indicados os ficheiros a que deve recorrer em caso de dúvida. Esta estrutura procura dar a entender o método de usa da API da forma mais simplificada possível.</p>
<ul>
<li>
<p><strong>Uso de Sistemas Elementares</strong>
Para utilizar os sistemas elementares de gestão de entidades, deverá recorrer ao seguinte URL:
<code>http://localhost:8081/api/entidade</code>
Onde 8081 é a porta em que a API está localizada, mais sobre isso mais tarde, e entidade poderá ser substituída por qualquer entidade principal da aplicação, a seguir:</p>
<ul>
<li>area;</li>
<li>category;</li>
<li>difficulty;</li>
<li>ingredient;</li>
<li>recipe;</li>
<li>user.</li>
</ul>
<p>Portanto, para puder consultar as categorias disponíveis na base de dados, poderá utilizar:
<code>http://localhost:8081/api/category</code></p>
</li>
<li>
<p><strong>Enviar Parâmetros</strong></p>
<ul>
<li>Como deve calcular, sendo que esta API segue uma arquitetura RESTful, a gestão de cada uma das entidades envolve também o envio de parâmetros para especificar em qual das instâncias da entidade se pretende realizar uma dada operação.</li>
<li>Para tal, pode ser introduzido um id logo após a entidade e uma barra &quot;/&quot;:
<code>http://localhost:8081/api/entidade/id</code>
Portanto, seguindo o exemplo anterior da categoria, para puder aceder a categoria com o id=5, deverá utilizar o seguinte URL:
<code>http://localhost:8081/api/category/5</code></li>
</ul>
</li>
<li>
<p><strong>Autenticar identidade</strong>
Para que um utilizador autentique a sua identidade, o mesmo deverá realizar um <em>login</em>, e no caso de não possuir conta, um <em>signup</em>.
Com uma conta, um utilizador será capaz de utilizar rotas adicionais, pois as únicas rotas que os utilizadores sem conta poderão executar serão as de visualização, com a exceção de visualização de utilizadores e <em>seeding</em>.
Para iniciar sessão, o mesmo poderá fazê-lo com o método POST no seguinte URL:
<code>http://localhost:8081/api/user/login</code>
E deverá de enviar um corpo JSON no seguinte formato:</p>
<pre><code class="language-bash">{
  <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;theusername&quot;</span>,
  <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;thepassword&quot;</span>
}
</code></pre>
<p>Após iniciar sessão, poderá copiar um token que será recebido, e utilizá-lo para autenticar as suas próximas ações. Para o fazer, deve enviar um cabeçalho com o seguinte nome
<code>x-access-token</code> em conjunto do seu token.</p>
</li>
<li>
<p><strong>Enviar um Corpo</strong>
Para enviar um corpo nos pedidos para a gestão dos serviços elementares, ou seja, para puder criar e alterar um dado recurso, existe um truque bastante simples, que ainda assim, vale a pena ser analisado.
Sempre que quiser, por exemplo, adicionar um ingrediente através da API, é aconselhado que seja realizado um pedido à API do ingrediente, e copie a resposta. Com essa resposta, deverá colá-la no corpo JSON que quer enviar à API, com os seus valores alterados. Desta maneira garante que nunca se enganará.
Sempre que seguir esta regra, de utilizar o mesmo formato que recebe para enviar, poderá escapar ao código HTTP 400 e 422. No entanto, existe uma outra regra, que provavelmente o poderá ajudar. Sempre que tiver de enviar uma receita, por exemplo, poderá enviar apenas o id do autor, ingredient, região (area), pois o resto dos dados não serão lidos, apenas o id será guardado.</p>
</li>
<li>
<p><strong>Serviços Baseados em Relacionamentos</strong>
Existem diversos serviços baseados em relacionamentos, tais como as listas de receitas, os favoritos, bem como a gestão de ingredientes de uma receita, e estes devem ser consultados diretamente ao respetivo ficheiro de rotas que será mencionado mais tarde.
No entanto, sempre que se quiser adicionar um ingrediente a uma receita, poderá utilizar uma rota que segue a arquitetura RESTful, por exemplo:
<code>http://localhost:8081/api/recipe/recipe_id/ingredient/ingredient_id</code>
Acima, poderá ver o URL que deve ser utilizado para adicionar um ingrediente a uma receita, podendo também reparar que o parent, ou a receita, deverá estar sempre em primeiro lugar, enquanto que o filho, ou ingredient, deve ser provido por último.</p>
</li>
<li>
<p><strong>Descrição das Rotas</strong>
Para que possa consultar de forma mais clara as rotas disponíveis nesta API deve aceder ao seguinte ficheiro a partir da raiz do projeto:
<code>/api/routes/index.js</code>
No ficheiro acima estão descritas as rotas das entidades disponíveis desta API, como também pode encontrar os ficheiros designados a cada uma das rotas específicas.</p>
</li>
</ul>
<h3 id="exemplos-práticos">Exemplos Práticos:</h3>
<p>Nesta parte serão dados alguns exemplos de como utilizar a API. Estarão presentes exemplos desde como realizar pedidos mais técnicos que não foram abordados previamente, como também como corrigir problemas no caso dos mesmo surgirem.</p>
<ul>
<li>
<p><strong>Tipos de Rotas</strong>
Como deve prever, existem diferentes tipos de rotas disponíveis nesta API, e de seguida serão apresentadas algumas das rotas que deverão ser mais utilizadas com exemplos práticos e funcionais:</p>
<ul>
<li>Consultar todas as receitas:
<ul>
<li>Método: <code>&quot;GET&quot;</code></li>
<li><code>http://localhost:8081/api/recipe</code></li>
</ul>
</li>
<li>Consultar um ingrediente:
<ul>
<li>Método: <code>&quot;GET&quot;</code></li>
<li><code>http://localhost:8081/api/ingredient/378</code></li>
</ul>
</li>
<li>Criar uma area (região):
<ul>
<li>Método: <code>&quot;POST&quot;</code></li>
<li><code>http://localhost:8081/api/area</code></li>
<li>Corpo:</li>
</ul>
<pre><code class="language-bash">{
  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Portuguese&quot;</span>
}
</code></pre>
<ul>
<li>Cabeçalho:</li>
</ul>
<pre><code class="language-bash">{ x-access-token: token }
</code></pre>
</li>
<li>Editar o utilizador predefinido (1)
<ul>
<li>Método: <code>&quot;PUT&quot;</code></li>
<li><code>http://localhost:8081/api/user/1</code></li>
<li>Corpo:</li>
</ul>
<pre><code class="language-bash">{
  <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;newUsername&quot;</span>,
  <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;new@email.com&quot;</span>,
  <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;myNewPassword&quot;</span>,
  <span class="hljs-string">&quot;firstName&quot;</span>: <span class="hljs-string">&quot;newName&quot;</span>,
  <span class="hljs-string">&quot;lastName&quot;</span>: <span class="hljs-string">&quot;newLast&quot;</span>,
  <span class="hljs-string">&quot;image&quot;</span>: <span class="hljs-string">&quot;newImageURL&quot;</span>,
  <span class="hljs-string">&quot;isAdmin&quot;</span>: 1
}
</code></pre>
<ul>
<li>Notas: A palavra passe será codificada antes de inserida na base de dados.</li>
<li>Cabeçalho:</li>
</ul>
<pre><code class="language-bash">{ x-access-token: token }
</code></pre>
</li>
<li>Remover uma receita (33)
<ul>
<li>Método: <code>&quot;DELETE&quot;</code></li>
<li><code>http://localhost:8081/api/recipe/33</code></li>
<li>Cabeçalho:</li>
</ul>
<pre><code class="language-bash">{ x-access-token: token }
</code></pre>
</li>
<li>Adicionar um ingredient (5) a uma receita (33)
<ul>
<li>Método: <code>&quot;POST&quot;</code></li>
<li><code>http://localhost:8081/api/recipe/33/ingredient/55</code></li>
<li>Corpo:</li>
</ul>
<pre><code class="language-bash">{
  <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-string">&quot;A gosto&quot;</span>
}
</code></pre>
<ul>
<li>Cabeçalho:</li>
</ul>
<pre><code class="language-bash">{ x-access-token: token }
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Especificações</strong>
Para um uso correto das rotas, as mesmas estão preparadas com mensagens customizadas com códigos HTTP intuitivos para que o utilizador da API seja guiado a corrigir o seu pedido.
Vale referir que ainda existem outras nuances que serão descritas em secções futuras sobre a população da API com dados provenientes de uma outra API, como também detalhes sobre parâmetros de pesquisa sobre as entidades.</p>
</li>
</ul>
<h2 id="integração-de-serviços-externos">Integração de Serviços Externos</h2>
<p>Esta API, como mencionado anteriormente, é capaz de utilizar uma API externa para popular a base de dados. Sendo ela a API <a href="https://www.themealdb.com/api.php">TheMealDB</a>.
Existem quatro rotas que convertem as respostas provenientes desta API nos modelos utilizados pela base de dados desta aplicação, para depois ser inserida na mesma. Sendo as rotas as seguintes:</p>
<ul>
<li><code>http://localhost:8081/api/seed/categories</code></li>
<li><code>http://localhost:8081/api/seed/ingredients</code></li>
<li><code>http://localhost:8081/api/seed/areas</code></li>
<li><code>http://localhost:8081/api/seed/recipes</code>
Deve manter em mente que para criar as receitas, é necessário ter criado as regiões, ingredientes e categorias primeiro.
Mas para facilitar a população de dados, foi também criada a seguinte rota:</li>
</ul>
<pre><code class="language-bash">http://localhost:8081/api/seed/all
</code></pre>
<p>Esta está responsável por executar todas as rotas da ordem correta sem dificuldades ou transtornos. Recomenda-se utilizar apenas esta para evitar qualquer tipo de transtorno.
Mas ainda há mais, com o uso de um parâmetro de pesquisa, é capaz de forçar essas quatro tabelas a reiniciar, podendo inserir os dados a qualquer momento. Ainda assim, é recomendado que a população seja efetuada antes que utilizadores comecem a utilizar a aplicação e comecem a criar listas com receitas temporárias. Abaixo está a rota de população geral com o parâmetro adicional:</p>
<pre><code class="language-bash">http://localhost:8081/api/seed/all?force=<span class="hljs-literal">true</span>
</code></pre>
<h2 id="funcionalidades-implementadas">Funcionalidades Implementadas</h2>
<p>Algumas das funcionalidades presentes consistem na gestão das respetivas entidades referidas anteriormente, bem como na realização de relacionamentos entre elas e a gestão destes, como também na população da base de dados referida anteriormente, e, autenticação e detalhes sobre autorização, e por fim, o uso de parâmetros de pesquisa adicionais para as mais importantes entidades.</p>
<ul>
<li>
<p><strong>Gestão de Entidades</strong>
Para evitar que a mesma coisa seja repetida vezes sem conta, é aconselhado que seja verificada a rota de pesquisa de uma dada entidade (GET), e verifique como é que o corpo é organizado, pois este é valido para inserção e atualização de recursos também.</p>
</li>
<li>
<p><strong>Relacionamentos</strong>
Novamente, como referido anteriormente, é possível relacionar entidades, tal como, ingredientes a receitas, receitas favoritas de um utilizador, listas de receitas a um utilizador, bem como, receitas a uma dada lista.
No entanto, diferentes rotas podem precisar de corpos diferentes, como é o caso do ingrediente que deve receber a sua quantidade no corpo. No entanto, caso siga o URL abaixo, será capaz de realizar a maioria das ações de associação, ou, pelo menos, ser guiado a como corrigi-las:</p>
</li>
</ul>
<pre><code class="language-bash">http://localhost:8081/api/entidade/id_entidade/sub_entidade/id_sub_entidade
</code></pre>
<p>Vale acrescentar que existem rotas, como no caso das listas personalizadas de receitas de utilizadores pode ainda existir uma terceira entidade a referir, mas novamente, ao consultar o ficheiro de rotas individual da entidade, será capaz de encontrar esses detalhes.</p>
<ul>
<li>
<p><strong>Autenticação:</strong>
A autenticação nesta aplicação é realizada através de (JSW) Json Web Tokens, que permitem assinar e verificar um dado token, a sua validade, bem como dados inseridos na mesma através do uso de uma palavra secreta. Coincidentemente, esta palavra secreta pode ser encontrada no ficheiro <code>.env</code>.
Pode consultar a base de dados e verificar que o único utilizador por definição é o &quot;admin&quot;, cuja palavra passe é também admin. É aconselhado atualizar a palavra passe do administrador o quanto antes através de uma de duas rotas:</p>
<ul>
<li><code>http://localhost:8081/api/user/changePassword</code> (recomendada)
<ul>
<li>Esta rota deve receber três elementos no corpo, <code>oldPassword</code>, <code>newPassword</code>, <code>repeatNewPassword</code></li>
</ul>
</li>
<li>Ou então utilizar a edição de utilizador disponível na gestão básica de entidades
<ul>
<li><code>http://localhost:8081/api/user/1</code></li>
</ul>
</li>
<li>Deve ter em atenção que é necessário enviar o token de autenticação para ambas as rotas, logo, deverá realizar login primeiro para obter o token de administrador.</li>
</ul>
</li>
<li>
<p><strong>Parâmetros de Pesquisa:</strong>
Nesta API existem também diversos parâmetros de pesquisa para as seguintes entidades:</p>
<ul>
<li>Category, Ingredient, Recipe;</li>
<li>Como mencionado acima, o <em>seeder</em> também possui o um parâmetro de <em>force</em>, ainda que não deva ser considerada uma entidade.</li>
</ul>
</li>
</ul>
<p>Ainda assim, as entidades acima possuem diversos parâmetros de pesquisa, tais como nome, tamanho máximo, aleatoriedade, e muitos outros. Estes foram implementados para que pudesse ser realizada uma pesquisa mais personalizada às entidades mais relevantes. Dado o tempo disponibilizado para o desenvolvimento da API, os desenvolvedores tiveram de se concentrar em acrescentar funcionalidades, ao invés de replicar as mesmas funcionalidades para todas as entidades.</p>
<ul>
<li><em>Lista extensiva de parâmetros de pesquisa</em>
Os parâmetros podem ser observados com mais detalhe na rota de consulta global de cada uma das entidades mencionadas acima, ainda assim, para fins de demonstração, a consulta de receitas possui os seguintes parâmetros:
<ul>
<li>order
<ul>
<li>Define por que atributo deve ser realizada a ordenação.</li>
</ul>
</li>
<li>max
<ul>
<li>Define o limite de registos a receber.</li>
</ul>
</li>
<li>random
<ul>
<li>Define que a ordenação deve ser aleatória.</li>
</ul>
</li>
<li>name
<ul>
<li>Pesquisa apenas receitas que incluem o nome enviado por parâmetro.</li>
</ul>
</li>
<li>partial
<ul>
<li>Dá a saber à API que a pesqusia é parcial, ou seja, mais adequada para ser apresentada em cartões (apenas a imagem, nome, id e chaves estrangeiras são enviados).</li>
</ul>
</li>
<li>named
<ul>
<li>Caso a pesquisa seja parcial, quando a pesquisa também é nomeada, enviará os nomes respetivos às chaves estrangeiras (id da categoria e o seu nome), normalmente usado em tabelas de backoffice.</li>
</ul>
</li>
<li>area
<ul>
<li>Pesquisa receitas de uma dada região (por id).</li>
</ul>
</li>
<li>category
<ul>
<li>Pesquisa receitas de uma dada categoria (por id).</li>
</ul>
</li>
<li>author
<ul>
<li>O mesmo para o autor.</li>
</ul>
</li>
<li>difficulty
<ul>
<li>O mesmo para a dificuldade.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="tecnologias-utilizadas">Tecnologias Utilizadas</h2>
<p>Conforme aprendido em aulas da unidade curricular, foi escolhido utilizar o Node.js com o Express.js para desenvolver o backend da aplicação, não apenas a API, bem como também as rotas da frontend.
Foi também decidido utilizar o MySQL devido à sua facilidade de uso e aprendizado da mesma em cadeiras anteriores.
Como também foram utilizadas outras ferramentas ainda não mencionadas, sendo elas:</p>
<ul>
<li><a href="https://github.com/janl/mustache.js/">Mustache</a>
<ul>
<li>Motor de templates que permite a inicialização de páginas HTML de forma mais dinâmica e simplificada.</li>
</ul>
</li>
<li><a href="https://getbootstrap.com/">Bootstrap 5</a>
<ul>
<li>Framework que embeleza uma aplicação web (frontend).</li>
</ul>
</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/JSON">JSON</a>
<ul>
<li>Notação moderna usada para comunicar entre o backend e frontend.</li>
<li>Esta API utilizará JSON para enviar qualquer tipo de recurso. Só enviará texto em caso de erro ou não fazer sentido enviar um objeto.</li>
</ul>
</li>
<li>Ainda que seja óbvio, foi também utilizado HTML e CSS para o desenvolvmento das páginas web, bem como JavaScript para programar estas páginas e programar o backend com Node.js.</li>
</ul>
<p>Existem também alguns módulos do NPM que podem e devem ser considerados nesta lista, sendo estes:</p>
<ul>
<li>Axios
<ul>
<li>Utilizado para realizar pedidos no backend, também funciona no frontend.</li>
</ul>
</li>
<li>Json Web Token
<ul>
<li>Bastante útil para realizar a autenticação e verificação de autorização.</li>
</ul>
</li>
<li>Bcrypt
<ul>
<li>Permite codificar palavras passe e verificar a igualdade das mesmas.</li>
</ul>
</li>
</ul>
<h2 id="mais-informações">Mais Informações</h2>
<p>Para mais informações, pode consultar o manual de utilizador, que dará uma melhor perspetiva numa ótica de utilizador.</p>

            
            
        </body>
        </html>